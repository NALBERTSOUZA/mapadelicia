<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Mapa de Mesas</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
}

html, body{
  width:100vw;
  height:100vh;
  overflow:hidden;
  font-family:Inter;
  background:#e5e7eb;
}

/* TOPO */
header{
  height:64px;
  background:#0f172a;
  color:#fff;
  display:flex;
  align-items:center;
  padding:0 20px;
  gap:12px;
}

header button, header select, header input{
  height:36px;
  border-radius:8px;
  border:none;
  padding:0 12px;
}

header button{
  background:#22c55e;
  color:#fff;
  font-weight:600;
  cursor:pointer;
}

/* PALCO */
#palco{
  position:relative;
  width:100%;
  height:calc(100vh - 64px);
  background:#f8fafc;
}

/* MESA */
.mesa{
  position:absolute;
  cursor:grab;
  user-select:none;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:700;
  color:#1f2937;
}

/* FORMAS */
.quadrada{
  width:110px;
  height:110px;
  border-radius:14px;
  background:#94a3b8;
}

.redonda{
  width:110px;
  height:110px;
  border-radius:50%;
  background:#94a3b8;
}

/* CADEIRAS */
.cadeira{
  position:absolute;
  width:18px;
  height:18px;
  background:#334155;
  border-radius:4px;
}

/* STATUS */
.ocupada{ background:#f59e0b !important; color:#fff }
.livre{ background:#94a3b8 }

/* MODAL */
#modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.5);
  display:none;
  align-items:center;
  justify-content:center;
}

#modal .box{
  background:#fff;
  width:320px;
  padding:20px;
  border-radius:12px;
}

#modal input{
  width:100%;
  padding:10px;
  margin-bottom:10px;
}

#modal button{
  width:100%;
  padding:12px;
  border:none;
  border-radius:8px;
  cursor:pointer;
}

.salvar{ background:#0f172a; color:#fff }
.limpar{ background:#ef4444; color:#fff; margin-top:8px }
</style>
</head>

<body>

<header>
  <strong>üçΩÔ∏è Mapa de Mesas</strong>

  <select id="tipo">
    <option value="quadrada">Quadrada</option>
    <option value="redonda">Redonda</option>
  </select>

  <input id="lugares" type="number" placeholder="Lugares" min="2">
  <button onclick="adicionarMesa()">Adicionar Mesa</button>
</header>

<div id="palco"></div>

<!-- MODAL -->
<div id="modal">
  <div class="box">
    <h3>Reserva</h3>
    <input id="cliente" placeholder="Nome do cliente">
    <button class="salvar" onclick="salvarCliente()">Salvar</button>
    <button class="limpar" onclick="limparMesa()">Liberar Mesa</button>
  </div>
</div>

<script>
const palco = document.getElementById('palco');
const modal = document.getElementById('modal');
let mesaAtual = null;

/* ADICIONAR MESA */
function adicionarMesa(){
  const tipo = document.getElementById('tipo').value;
  const lugares = document.getElementById('lugares').value;

  if(!lugares) return;

  const mesa = document.createElement('div');
  mesa.className = `mesa ${tipo} livre`;
  mesa.style.left = '50%';
  mesa.style.top = '50%';
  mesa.innerText = lugares;

  criarCadeiras(mesa, lugares);

  mesa.onmousedown = e => arrastar(e, mesa);
  mesa.onclick = e => {
    e.stopPropagation();
    abrirModal(mesa);
  };

  palco.appendChild(mesa);
}

/* CADEIRAS */
function criarCadeiras(mesa, lugares){
  for(let i=0;i<lugares;i++){
    const c = document.createElement('div');
    c.className = 'cadeira';
    const ang = (360/lugares)*i;
    const r = 65;
    c.style.left = 50 + r*Math.cos(ang*Math.PI/180) + '%';
    c.style.top = 50 + r*Math.sin(ang*Math.PI/180) + '%';
    mesa.appendChild(c);
  }
}

/* DRAG */
function arrastar(e, el){
  const startX = e.clientX - el.offsetLeft;
  const startY = e.clientY - el.offsetTop;

  document.onmousemove = ev => {
    el.style.left = ev.clientX - startX + 'px';
    el.style.top = ev.clientY - startY + 'px';
  };

  document.onmouseup = () => {
    document.onmousemove = null;
  };
}

/* MODAL */
function abrirModal(m){
  mesaAtual = m;
  modal.style.display = 'flex';
  cliente.value = m.dataset.cliente || '';
}

function salvarCliente(){
  mesaAtual.dataset.cliente = cliente.value;
  mesaAtual.classList.add('ocupada');
  modal.style.display = 'none';
}

function limparMesa(){
  mesaAtual.dataset.cliente = '';
  mesaAtual.classList.remove('ocupada');
  modal.style.display = 'none';
}

modal.onclick = e => {
  if(e.target === modal) modal.style.display = 'none';
};
</script>

</body>
</html>
