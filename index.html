<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Teste Supabase – mapa_mesas</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body{
  font-family: Arial, sans-serif;
  padding:20px;
}
button{
  padding:10px 16px;
  margin-right:10px;
}
pre{
  background:#111;
  color:#0f0;
  padding:10px;
  margin-top:20px;
  max-height:300px;
  overflow:auto;
}
.error{
  color:#ff4d4d;
}
</style>
</head>

<body>

<h2>Teste Supabase – mapa_mesas</h2>

<button onclick="inserir()">Inserir Registro</button>
<button onclick="listar()">Listar Registros</button>

<pre id="log">Aguardando ação...</pre>

<script>
// ================== SUPABASE ==================
const SUPABASE_URL = 'https://fzyosadzuvbktvmnzdpf.supabase.co'
const SUPABASE_ANON_KEY = 'sb_publishable_VuMi0uFLuzTAPdSL36uyNg_YhD_uPK0'

// ✅ OBJETO CORRETO
const supabase = supabase.createClient(
  SUPABASE_URL,
  SUPABASE_ANON_KEY
)

const logEl = document.getElementById('log')

function log(msg, isError=false){
  logEl.className = isError ? 'error' : ''
  logEl.textContent =
    typeof msg === 'string'
      ? msg
      : JSON.stringify(msg, null, 2)
}

// ================== TESTE INSERT ==================
async function inserir(){
  log('Inserindo registro...')

  try{
    const { data, error } = await supabase
      .from('mapa_mesas')
      .insert({
        elemento_id: '71805376-fdae-44cd-a498-18e00cc86e37',
        x: Math.floor(Math.random()*500),
        y: Math.floor(Math.random()*300)
      })
      .select()

    if(error){
      log(error, true)
    }else{
      log(data)
    }
  }catch(err){
    log(err, true)
  }
}

// ================== TESTE SELECT ==================
async function listar(){
  log('Buscando registros...')

  try{
    const { data, error } = await supabase
      .from('mapa_mesas')
      .select('*')
      .order('criado_em', { ascending:false })

    if(error){
      log(error, true)
    }else{
      log(data)
    }
  }catch(err){
    log(err, true)
  }
}
</script>

</body>
</html>
