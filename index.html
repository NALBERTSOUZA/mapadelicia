<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Mapa de Mesas ‚Ä¢ Restaurante</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --bg:#f4f6f8;
  --primary:#2563eb;
  --border:#dcdfe4;
  --green:#16a34a;
  --chair:#111827;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:Inter, Arial, sans-serif;
  background:var(--bg);
  display:flex;
  height:100vh;
}

/* SIDEBAR */
aside{
  width:280px;
  background:#0f172a;
  color:#fff;
  padding:20px;
}

button{
  width:100%;
  padding:10px;
  margin-bottom:10px;
  border:none;
  border-radius:6px;
  background:var(--primary);
  color:#fff;
  cursor:pointer;
  font-weight:600;
}

button.secondary{background:#334155}

/* ELEMENTOS */
.elementos{
  margin-top:20px;
  display:flex;
  flex-direction:column;
  gap:10px;
}

.elemento{
  background:#1e293b;
  padding:10px;
  border-radius:6px;
  cursor:grab;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:13px;
  border:1px dashed #475569;
}

/* MAPA */
main{flex:1;padding:20px}

#mapa{
  position:relative;
  background:#fff;
  border:2px dashed var(--border);
  height:100%;
  border-radius:12px;
  overflow:hidden;
}

/* MESA */
.mesa-wrapper{
  position:absolute;
  cursor:grab;
}

.mesa{
  position:absolute;
  background:#e5e7eb;
  border:2px solid #9ca3af;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:12px;
  font-weight:600;
  text-align:center;
}

.mesa.reservada{
  background:var(--green);
  color:#fff;
}

.selected .mesa{
  border-color:var(--primary);
}

/* FORMATOS */
.quadrada .mesa{width:60px;height:60px}
.retangular .mesa{width:90px;height:60px}
.redonda .mesa{border-radius:50%}

/* CADEIRAS */
.chair{
  position:absolute;
  width:18px;
  height:8px;
  background:var(--chair);
  border-radius:4px;
}

/* MODAL */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.4);
  display:none;
  align-items:center;
  justify-content:center;
}
.modal.active{display:flex}

.modal-box{
  background:#fff;
  padding:20px;
  width:320px;
  border-radius:10px;
}

.modal-box label{
  font-size:13px;
  margin-top:10px;
  display:block;
}

.modal-box input{
  width:100%;
  padding:8px;
  margin-top:4px;
}

.modal-actions{
  margin-top:15px;
  display:flex;
  gap:10px;
}
</style>
</head>

<body>

<aside>
  <h2>Mapa de Mesas</h2>
  <button class="secondary" onclick="removerMesa()">üóëÔ∏è Remover Mesa</button>

  <div class="elementos">
    <div class="elemento" draggable="true" data-tipo="quadrada">üü¶ Mesa Quadrada (2)</div>
    <div class="elemento" draggable="true" data-tipo="retangular">üüß Mesa Retangular (4)</div>
    <div class="elemento" draggable="true" data-tipo="redonda">‚ö™ Mesa Redonda</div>
  </div>
</aside>

<main>
  <div id="mapa"></div>
</main>

<!-- MODAL REDONDA -->
<div class="modal" id="modalRedonda">
  <div class="modal-box">
    <h3>Mesa Redonda</h3>

    <label>Raio (px)</label>
    <input id="raioMesa" type="number" value="35">

    <label>Quantidade de cadeiras</label>
    <input id="qtdCadeiras" type="number" value="6" min="1">

    <div class="modal-actions">
      <button onclick="confirmarRedonda()">Confirmar</button>
      <button class="secondary" onclick="fecharRedonda()">Cancelar</button>
    </div>
  </div>
</div>

<script>
const mapa=document.getElementById('mapa')
let selecionada=null
let pendente=null

/* DRAG DOS ELEMENTOS */
document.querySelectorAll('.elemento').forEach(el=>{
  el.ondragstart=e=>{
    e.dataTransfer.setData('tipo',el.dataset.tipo)
  }
})

mapa.ondragover=e=>e.preventDefault()

mapa.ondrop=e=>{
  e.preventDefault()
  const tipo=e.dataTransfer.getData('tipo')
  const x=e.offsetX
  const y=e.offsetY

  if(tipo==='redonda'){
    pendente={x,y}
    modalRedonda.classList.add('active')
  }else{
    criarMesa(tipo,x,y)
  }
}

/* CRIA√á√ÉO */
function criarMesa(tipo,x,y){
  const wrap=document.createElement('div')
  wrap.className='mesa-wrapper '+tipo
  wrap.style.left=x+'px'
  wrap.style.top=y+'px'

  const mesa=document.createElement('div')
  mesa.className='mesa'
  mesa.textContent='Mesa'

  if(tipo==='redonda'){
    const r=Number(raioMesa.value)
    const qtd=Number(qtdCadeiras.value)
    mesa.style.width=r*2+'px'
    mesa.style.height=r*2+'px'
    criarCadeirasCirculo(wrap,r,qtd)
  }else{
    criarCadeirasLados(wrap,tipo)
  }

  wrap.appendChild(mesa)
  mapa.appendChild(wrap)
  ativar(wrap,mesa)
  drag(wrap)
}

/* CONFIRMA REDONDA */
function confirmarRedonda(){
  criarMesa('redonda',pendente.x,pendente.y)
  fecharRedonda()
}

function fecharRedonda(){
  pendente=null
  modalRedonda.classList.remove('active')
}

/* CADEIRAS */
function criarCadeirasLados(wrap,tipo){
  const pos = tipo==='retangular'
    ? [[30,-10],[60,-10],[30,60],[60,60]]
    : [[26,-10],[26,60]]

  pos.forEach(p=>{
    const c=document.createElement('div')
    c.className='chair'
    c.style.left=p[0]+'px'
    c.style.top=p[1]+'px'
    wrap.appendChild(c)
  })
}

function criarCadeirasCirculo(wrap,r,qtd){
  const dist=r+6
  for(let i=0;i<qtd;i++){
    const ang=(i/qtd)*Math.PI*2
    const c=document.createElement('div')
    c.className='chair'
    c.style.left=(r+Math.cos(ang)*dist)+'px'
    c.style.top =(r+Math.sin(ang)*dist)+'px'
    const rot=ang*(180/Math.PI)+90
    c.style.transform=`translate(-50%,-50%) rotate(${rot}deg)`
    wrap.appendChild(c)
  }
}

/* INTERA√á√ÉO */
function ativar(wrap,mesa){
  wrap.onclick=()=>{
    document.querySelectorAll('.mesa-wrapper').forEach(m=>m.classList.remove('selected'))
    wrap.classList.add('selected')
    selecionada=wrap
  }
  wrap.mesa=mesa
}

function removerMesa(){
  if(selecionada){selecionada.remove();selecionada=null}
}

function drag(el){
  let x=0,y=0
  el.onmousedown=e=>{
    x=e.clientX;y=e.clientY
    document.onmousemove=ev=>{
      el.style.left=el.offsetLeft+(ev.clientX-x)+'px'
      el.style.top =el.offsetTop +(ev.clientY-y)+'px'
      x=ev.clientX;y=ev.clientY
    }
    document.onmouseup=()=>document.onmousemove=null
  }
}
</script>

</body>
</html>
