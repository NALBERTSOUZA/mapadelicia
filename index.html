<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Reservas de Mesas ‚Ä¢ Restaurante</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
:root{
  --bg:#0f0f10;
  --card:#18181b;
  --line:#2a2a2e;
  --text:#f4f4f5;
  --muted:#a1a1aa;
  --primary:#22c55e;
  --danger:#ef4444;
  --warning:#facc15;
}

*{box-sizing:border-box}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:Inter,system-ui;
}

header{
  padding:20px;
  font-size:20px;
  font-weight:700;
  border-bottom:1px solid var(--line);
}

.container{
  max-width:1100px;
  margin:auto;
  padding:20px;
}

.card{
  background:var(--card);
  border:1px solid var(--line);
  border-radius:14px;
  padding:20px;
  margin-bottom:20px;
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
  gap:14px;
}

input,select{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:1px solid var(--line);
  background:#0b0b0c;
  color:var(--text);
  font-size:14px;
}

button{
  padding:12px;
  border-radius:10px;
  border:none;
  font-weight:600;
  cursor:pointer;
}

.btn-primary{background:var(--primary);color:#052e16}
.btn-danger{background:var(--danger);color:#fff}
.btn-warning{background:var(--warning);color:#422006}

table{
  width:100%;
  border-collapse:collapse;
}

th,td{
  padding:14px;
  border-bottom:1px solid var(--line);
  text-align:left;
}

th{
  font-size:12px;
  color:var(--muted);
}

.status{
  padding:6px 10px;
  border-radius:999px;
  font-size:12px;
  font-weight:700;
}

.pago{background:#052e16;color:#22c55e}
.pendente{background:#422006;color:#facc15}

.actions button{
  margin-right:6px;
}
</style>
</head>

<body>

<header>üçΩÔ∏è Reservas de Mesas</header>

<div class="container">

  <!-- FORM RESERVA -->
  <div class="card">
    <h3>Nova / Editar Reserva</h3>

    <div class="grid">
      <input id="mesa" placeholder="Mesa n¬∫">
      <input id="cliente" placeholder="Nome do cliente">
      <input id="telefone" placeholder="Telefone">
      <input id="data" type="date">
      <input id="hora" type="time">

      <select id="status">
        <option value="pendente">Pendente</option>
        <option value="pago">Pago</option>
      </select>
    </div>

    <br>
    <button class="btn-primary" onclick="salvarReserva()">Salvar Reserva</button>
  </div>

  <!-- LISTA -->
  <div class="card">
    <h3>Reservas</h3>

    <table>
      <thead>
        <tr>
          <th>Mesa</th>
          <th>Cliente</th>
          <th>Telefone</th>
          <th>Data</th>
          <th>Hora</th>
          <th>Status</th>
          <th>A√ß√µes</th>
        </tr>
      </thead>
      <tbody id="lista"></tbody>
    </table>
  </div>

</div>

<script>
// ================== CONFIG SUPABASE ==================
const supabase = supabase.createClient(
  "https://SUA_URL.supabase.co",
  "SUA_ANON_KEY"
)

// ================== VARI√ÅVEIS ==================
let editId = null

// ================== LOAD ==================
carregarReservas()

// ================== CRUD ==================
async function carregarReservas(){
  const { data, error } = await supabase
    .from("reservas")
    .select("*")
    .order("data",{ascending:true})

  if(error) return alert(error.message)

  lista.innerHTML = ""
  data.forEach(r=>{
    lista.innerHTML += `
      <tr>
        <td>${r.mesa}</td>
        <td>${r.cliente}</td>
        <td>${r.telefone}</td>
        <td>${r.data}</td>
        <td>${r.hora}</td>
        <td>
          <span class="status ${r.status}">
            ${r.status.toUpperCase()}
          </span>
        </td>
        <td class="actions">
          <button class="btn-warning" onclick="editar(${r.id})">Editar</button>
          <button class="btn-danger" onclick="excluir(${r.id})">Excluir</button>
        </td>
      </tr>
    `
  })
}

async function salvarReserva(){
  const payload = {
    mesa: mesa.value,
    cliente: cliente.value,
    telefone: telefone.value,
    data: data.value,
    hora: hora.value,
    status: status.value
  }

  if(editId){
    await supabase.from("reservas").update(payload).eq("id",editId)
    editId = null
  }else{
    await supabase.from("reservas").insert(payload)
  }

  limpar()
  carregarReservas()
}

async function editar(id){
  const { data } = await supabase
    .from("reservas")
    .select("*")
    .eq("id",id)
    .single()

  editId = id
  mesa.value = data.mesa
  cliente.value = data.cliente
  telefone.value = data.telefone
  dataInput.value = data.data
  hora.value = data.hora
  status.value = data.status
}

async function excluir(id){
  if(confirm("Excluir reserva?")){
    await supabase.from("reservas").delete().eq("id",id)
    carregarReservas()
  }
}

function limpar(){
  mesa.value = ""
  cliente.value = ""
  telefone.value = ""
  data.value = ""
  hora.value = ""
  status.value = "pendente"
}
</script>

</body>
</html>
